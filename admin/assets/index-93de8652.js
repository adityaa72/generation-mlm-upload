import{a as M,c as X,d as Y,o as Z,j as i,F as I,g as R,e,l as ee,I as C,i as O,h as te,S as ae,R as N,aD as P,p as B,L as re,b_ as ie,E as oe,C as se,M as ne,t as H,w as ce,D as K,z as le,ao as z,T as de,B as V,b$ as ue,bd as pe,s as me,bB as he,bU as fe,f as j,c0 as ge,c1 as ye,c2 as Ce,P as De}from"./index-7ce534fb.js";import{r as p}from"./warn-once-223a138d.js";import{H as be}from"./HeaderBreadcrumbs-7dcdcbac.js";import{u as q}from"./EmptyContent-22072c99.js";import{D as xe}from"./DataTableClient-3fc18a4d.js";import{L as Q}from"./Label-c270b6e0.js";import{L as U}from"./LoadingIconButton-9648fa41.js";import{f as Ae}from"./formatTime-af0276ab.js";import{c as W}from"./index-2e108c35.js";import"./TableCell-b673782b.js";import"./Close-40502a6a.js";import"./Skeleton-7d8866f7.js";import"./index-1771e82c.js";import"./CardHeader-51eb309e.js";const _=({method:m,onClose:o,onBack:l,onCreate:d})=>{l||(l=o),d||(d=o);const h=m.config,u=h.map(({key:a})=>a),D=h.map(({label:a})=>a),b=h.map(({options:a})=>a),{details:n,name:g,gatewayId:T}=m,x=!!n;let f={charge:"",chargeType:""};const v={charge:M().required("Charge is required"),chargeType:M().required("Charge Type is required")};n?f=n:u.forEach((a,s)=>{f[a]=""}),u.forEach((a,s)=>{v[a]=M().required(`${D[s]} is required`)});const y=X().shape(v),G=Y({defaultValues:f,resolver:Z(y)}),{handleSubmit:A,formState:{isSubmitting:E}}=G;return i(I,{children:[i(R,{children:[e(ee,{onClick:l,children:e(C,{icon:"ic:round-keyboard-arrow-left"})}),x?i(I,{children:[" Update ",g," deposit gateway "]}):i(I,{children:[" Create ",g," deposit gateway"]})]}),e(O,{children:e(te,{methods:G,onSubmit:A(async a=>{try{await ie(T,a),d(),o()}catch(s){console.log("ðŸš€ ~ file: CreateDepositDialog.jsx:55 ~ onSubmit ~ error",s)}}),children:i(ae,{spacing:4,children:[u.map((a,s)=>{const S=b[s];return Array.isArray(S)?e(N,{select:!0,variant:"standard",name:a,label:D[s],children:S.map((k,w)=>e(P,{value:k,children:W(k)},w))},a):e(N,{variant:"standard",name:a,label:D[s]},a)}),i(N,{select:!0,variant:"standard",name:"chargeType",label:"Deposit Charge Type",children:[e(P,{value:"fixed",children:"Fixed"}),e(P,{value:"percent",children:"Percent"})]}),e(N,{maskNumber:!0,variant:"standard",name:"charge",label:"Deposit Charge"}),e(B,{sx:{textAlign:"right"},children:e(re,{type:"submit",loading:E,children:x?"Update":"Create"})})]})})})]})},Se=oe(se)(({theme:m,className:o})=>{const l={cursor:"pointer",border:"1px solid transparent"},d=o.split(" ").includes("active"),h=o.split(" ").includes("disabled");return d?{...l,boxShadow:`2px 7px 7px 2px ${ne(m.palette.primary.main,.4)}`,borderWidth:1,borderColor:m.palette.primary.main}:h?{opacity:.7,cursor:"not-allowed"}:{...l}}),we=({open:m,onClose:o,onCreate:l,createdGateways:d})=>{const h=H.GetAutomaticDepositGatewayCreateList,{data:u,isLoading:D}=ce([h],ue),b=(u==null?void 0:u.data)??[],[n,g]=p.useState(null),T=c=>g(c),[x,f]=p.useState(1),[v,y]=p.useState([]),G=()=>{const c=b.filter(a=>a.gatewayId===n)[0];f(2),y(c)},A=()=>{o(),g(null),f(1)};return i(K,{open:m,onClose:A,children:[D&&e(le,{}),x===1?i(I,{children:[e(R,{children:"Create a new automatic deposit"}),i(O,{children:[e(B,{sx:{display:"grid",gap:3,mt:4,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:b.map(({gatewayId:c,logo:a,image:s,name:S,config:k})=>{const w=n===c,F=d.includes(c);let L="";return w&&(L+=" active"),F&&(L+=" disabled"),i(Se,{onClick:F?null:()=>T(c),className:L,sx:{display:"grid",placeItems:"center",py:3,gap:4},children:[w&&e(B,{sx:{position:"absolute",right:6,top:6,color:"primary.main",fontSize:22},children:e(C,{icon:"ic:baseline-check-circle"})}),e(z,{disabledEffect:!0,sx:{height:30},alt:S,src:s}),e(de,{color:"text.secondary",children:S})]},c)})}),n&&e(B,{onClick:G,sx:{mt:4,textAlign:"right"},children:e(V,{endIcon:e(C,{icon:"ic:sharp-keyboard-arrow-right"}),children:"Create"})})]})]}):e(_,{onCreate:l,onBack:()=>f(1),onClose:A,gatewayId:n,method:v})]})},ve=()=>{const m=pe(),o=me(),[l,d]=p.useState(null),[h,u]=p.useState(null),[D,b]=p.useState(null),[n,g]=p.useState(null),[T,x]=p.useState({}),[f,v]=p.useState([]),y=H.GetAutomaticDepositGatewayList,G=f.map(({gatewayId:t})=>t),A=()=>{g(null),x({})},E=async t=>{u(t);try{const{data:r}=await ge(t);x(r),g(t)}catch(r){console.log("ðŸš€ ~ file: AutomaticDeposit.jsx:24 ~ updateGateway ~ error",r)}u(null)},c=async t=>{try{await m({description:`Are you sure you want to delete ${t} gateway?`}),b(t),await ye(t),o.invalidateQueries([y])}catch(r){console.log("ðŸš€ ~ file: AutomaticDeposit.jsx:24 ~ updateGateway ~ error",r)}finally{b(null)}},a=async(t,r)=>{d(t);try{await Ce(t,{status:r}),o.invalidateQueries([y])}catch(J){console.log("ðŸš€ ~ file: AutomaticDeposit.jsx:20 ~ changeStatus ~ error",J)}d(null)},s=[{field:"createdAt",sort:"desc"}],S=[{field:"name",headerName:q("method"),minWidth:200,flex:1,renderCell({row:{name:t,logo:r}}){return i(I,{children:[e(z,{disabledEffect:!0,alt:t,src:r,sx:{borderRadius:999,width:48,height:48,mr:2}}),t]})}},{field:"createdAt",headerName:q("created At"),minWidth:100,flex:1,renderCell({value:t}){return Ae(t)}},{field:"charge",headerName:q("deposit charge"),minWidth:100,flex:1,renderCell:({row:{charge:t,chargeType:r}})=>r==="fixed"?he(t):fe(t)},{field:"status",headerName:q("status"),minWidth:100,flex:1,renderCell({value:t}){return t=="active"?e(Q,{color:"success",children:W(t)}):e(Q,{color:"error",children:W(t)})}},{field:"action",headerName:q("action"),minWidth:100,flex:1,sortable:!1,renderCell({row:{status:t,gatewayId:r}}){return i(I,{children:[e(U,{loading:l===r,onClick:()=>a(r,t),children:t==="active"?e(C,{icon:j.eyeClosed}):e(C,{icon:j.eye})}),e(U,{loading:h===r,onClick:()=>E(r),children:e(C,{icon:j.pencil})}),e(U,{loading:D===r,onClick:()=>c(r),children:e(C,{icon:j.delete})})]})}}],[k,w]=p.useState(!1),F=()=>w(!0),L=()=>w(!1),$=()=>{o.removeQueries([y])};return i(B,{children:[!!n&&e(K,{onClose:A,open:!0,children:e(_,{onClose:A,gatewayId:n,method:T,onCreate:$})}),e(we,{createdGateways:G,open:k,onClose:L,onCreate:$}),e(xe,{action:e(V,{variant:"contained",onClick:F,startIcon:e(C,{icon:"carbon:add"}),children:"Create A New"}),title:"Automatic Deposits",queryKey:y,sortModel:s,columns:S,getRowId:"gatewayId",onReceiveData:t=>v(t)})]})},Ge=ve;function $e(){return i(De,{title:"Automatic Deposit Setting",children:[e(be,{heading:"Automatic Deposit Setting",links:[{name:"Payment Gateways"},{name:"Automatic Deposit"}]}),e(Ge,{})]})}export{$e as default};
