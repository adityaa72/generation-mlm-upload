import{at as Q,as as z,aS as J,u as O,A as u,y as U,z as _,D as M,a as r,P as X,j as e,L as Y,c as y,R as v,S as g,g as F,bd as k,T as Z,k as E,B as b,H as ee,J as m,K as ae,bJ as te,X as p,N as re,c7 as ie,q as D,c0 as se}from"./index-a3673b34.js";import{r as h}from"./warn-once-32b7c465.js";import{F as ne}from"./FormLabel-546d8bfa.js";import{H as de}from"./HeaderBreadcrumbs-006bc24f.js";import{v as oe}from"./formatTime-cc18d177.js";import{C as H}from"./CardHeader-a92719a0.js";import{C as q}from"./CardContent-73270362.js";import{A as le}from"./Alert-b65ce8b8.js";import"./Close-30065dfa.js";const ce=({userData:n,label:a,inputType:s,fileExtensions:x,dropdownOptions:P,name:d})=>{let t=n[d];switch(s==="date"&&t&&(t=oe(t)),s){case"input":case"date":return e(p,{disabled:!0,value:t,label:a});case"dropdown":return e(p,{disabled:!0,value:t,label:a});case"textarea":return e(p,{disabled:!0,multiline:!0,minRows:4,value:t,label:a});case"file":return r(b,{children:[e(ne,{label:a}),e(te,{disabled:!0,file:n[d]})]})}},Pe=()=>{const n=Q(),{id:a}=n,s=z(),x=J(),P=D.GetWithdrawGatewayDetails,{data:{data:{data:d={},userData:t={},gatewayName:G,userWallet:f=0,isUpdated:W}={}}={},isLoading:L}=O([P,a],()=>se(a)),{details:N=[],minWithdraw:o,maxWithdraw:B,charge:w,chargeType:S}=d;h.useEffect(()=>{W&&s(u.withdrawSystem.addMethod+"/"+a)},[W]);const T=U().shape({amount:_().required("Amount is required")}),A=M({defaultValues:{wallet:f,amount:0,charge:0,finalAmount:0},resolver:re(T)}),{handleSubmit:j,setValue:l,watch:R,formState:{isSubmitting:V}}=A,c=R("amount"),C=()=>S==="fixed"?w:c===0?0:c*w/100,$=()=>{const i=C();return Number(c)-Number(i)};h.useEffect(()=>{l("charge",C()),l("finalAmount",$())},[c]),h.useEffect(()=>{l("wallet",f)},[f]),h.useEffect(()=>{o&&l("amount",o)},[o]);const I=async i=>{try{await ie(a,i),x.invalidateQueries([D.FetchWithdrawHistory]),s(u.withdrawSystem.history)}catch(K){console.log("ðŸš€ ~ file: WithdrawPayment.jsx:72 ~ onSubmit ~ error",K)}};return r(X,{title:"Withdraw Payment",children:[e(de,{heading:"Withdraw Payment",links:[{name:"Dashboard",href:u.dashboard},{name:"Withdraw",href:u.withdrawSystem.methods},{name:"Withdraw Payment"}]}),L?e(Y,{}):r(y,{container:!0,spacing:v,children:[e(y,{item:!0,xs:12,md:6,children:r(g,{spacing:v,children:[r(F,{children:[e(H,{title:`Your ${G} details`}),e(k,{}),e(q,{children:e(g,{spacing:3,children:N.map(i=>e(ce,{userData:t,...i},i.name))})})]}),e(le,{sx:{mt:1},severity:"error",children:r(Z,{variant:"subtitle2",sx:{fontWeight:"bold"},children:["Withdraw Limit : ",E(o),e(b,{sx:{mx:.5},component:"span",children:"-"}),E(B)]})})]})}),e(y,{item:!0,xs:12,md:6,children:r(F,{children:[e(H,{title:"Withdraw Details"}),e(k,{}),e(q,{children:e(ee,{methods:A,onSubmit:j(I),children:r(g,{spacing:3,children:[e(m,{maskCurrency:!0,disabled:!0,name:"wallet",label:"Available Balance"}),e(m,{maskCurrency:!0,name:"amount",label:"Amount"}),e(m,{maskCurrency:!0,disabled:!0,name:"charge",label:`Withdraw Charge ${S==="percent"?`(${w}%)`:""} `}),e(m,{maskCurrency:!0,disabled:!0,name:"finalAmount",label:"Final Amount"}),e(b,{sx:{textAlign:"right"},children:e(ae,{type:"submit",size:"large",variant:"contained",loading:V,children:"Withdraw"})})]})})})]})})]})]})};export{Pe as default};
