import{s as W,b6 as se,av as F,cj as le,ck as ce,a as o,j as e,cl as de,B as w,T as S,I as Y,y as I,z as g,D as R,N as M,u as ue,cm as me,q as K,az as he,H as j,L as fe,c as u,J as b,cn as pe,g as L,Z as q,i as y,bP as $,bd as O,F as J,S as D,d as X,K as N,bC as ge,bU as ee,aS as G,co as ye,aO as _,cp as be,cq as we,bZ as xe,b_ as Ce,$ as ve,R as te,aT as Pe,aU as Se,aV as Ae,aC as Te,aB as Z,cr as H,as as Fe,ay as ke,Y as z,bF as qe,bG as B,cs as Ne,A as Ie,P as Le}from"./index-a3673b34.js";import{r as x}from"./warn-once-32b7c465.js";import{H as De}from"./HeaderBreadcrumbs-006bc24f.js";import{P as Ee,A as Re}from"./profile_cover-69ba8b9c.js";import{A as re}from"./Alert-b65ce8b8.js";import{A as ie}from"./AlertTitle-bce60c97.js";import{R as Me,E as je}from"./RHFTelInput-d8f2bdaa.js";import{C as V}from"./CardHeader-a92719a0.js";import{C as E}from"./CardContent-73270362.js";import{u as k,D as Oe}from"./DataTable-fbcfd2cf.js";import{f as Ve}from"./formatTime-cc18d177.js";import{c as U}from"./index-03944998.js";import{F as ze}from"./FormLabel-546d8bfa.js";import{R as Be}from"./RHFDatePicker-404d2b07.js";import{T as He,a as Ue}from"./Tabs-982306d4.js";import"./Close-30065dfa.js";import"./index-1771e82c.js";import"./EmptyContent-25dcb732.js";import"./Skeleton-179a775c.js";import"./KeyboardArrowRight-32007a10.js";function We(t){const[i,r]=x.useState(t||"");return{currentTab:i,onChangeTab:(a,s)=>{r(s)},setCurrentTab:r}}const Ke=W("div")(({theme:t})=>({"&:before":{...se().bgBlur({blur:2,color:t.palette.primary.darker}),top:0,zIndex:9,content:"''",width:"100%",height:"100%",position:"absolute"}})),$e=W("div")(({theme:t})=>({left:0,right:0,zIndex:99,position:"absolute",marginTop:t.spacing(5),[t.breakpoints.up("md")]:{right:"auto",display:"flex",alignItems:"center",left:t.spacing(3),bottom:t.spacing(3)}}));function Ge(){const{user:t,updateAvatar:i}=F(),{isSuccess:r,uploadFile:a,progress:s}=le(),l=x.useCallback(async d=>{try{const c=d[0];if(c){const p=new FormData;p.append("file",c);const{fileUrl:n}=await a(p);await ce(n),i(n)}}catch(c){console.log("ðŸš€ ~ file: ProfileCover.jsx:55 ~ handleDropSingleFile ~ error",c)}},[]);return o(Ke,{children:[o($e,{children:[e(de,{progress:s,onDrop:l,file:t==null?void 0:t.avatar,accept:"image/*"}),o(w,{sx:{ml:{md:3},mt:{xs:1,md:0},color:"common.white",textAlign:{xs:"center",md:"left"}},children:[e(S,{variant:"h4",children:t==null?void 0:t.displayName}),e(S,{sx:{opacity:.72},children:t==null?void 0:t.userId})]})]}),e(Y,{alt:"profile cover",isLocal:!0,src:Ee,sx:{position:"absolute",top:0,left:0,right:0,bottom:0}})]})}const Qe=()=>{const{user:{kyc:t,lastKyc:{status:i,rejectedReason:r}={}}}=F();return t==="rejected"?o(re,{sx:{mb:2},severity:"error",children:[e(ie,{children:"Kyc Rejected"}),r]}):null},ne=()=>{const[t,i]=x.useState(!1);return{isEditing:t,startEditing:()=>i(!0),stopEditing:()=>i(!1)}},_e=t=>je(t),Ze=({disabled:t=!1,action:i,onSuccess:r})=>{const a={address:"",country:"",state:"",city:"",pinCode:"",mobileNumber:""},s=I().shape({address:g().required("Address is required"),country:g().required("Country is required"),state:g().required("State is required"),city:g().required("City is required"),pinCode:g().required("Pin Code is required"),mobileNumber:g().required("Mobile Number is required").test("Phone","Mobile Number is not valid",_e)}),l=R({resolver:M(s),defaultValues:a}),{reset:d,handleSubmit:c,formState:{isSubmitting:p}}=l,n=async C=>{try{await pe(C),r&&r()}catch(v){console.log("ðŸš€ ~ file: ContactDetails.jsx:61 ~ onSubmit ~ error",v)}},m=x.useMemo(()=>({}),[]),{data:{data:h=m}={},isLoading:A}=ue([K.GetContactDetails],me);return x.useEffect(()=>{if(!he(h)){for(const[C,v]of Object.entries(h))v||(h[C]="");d(h)}},[h]),o(j,{methods:l,onSubmit:c(n),children:[A&&e(fe,{}),o(u,{container:!0,spacing:3,children:[e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:t,name:"address",type:"text",label:"Address"})}),e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:t,name:"country",type:"text",label:"Country"})}),e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:t,name:"state",type:"text",label:"State/Region"})}),e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:t,name:"city",type:"text",label:"City"})}),e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:t,name:"pinCode",type:"text",label:"Pin Code/Zip Code"})}),e(u,{item:!0,xs:12,md:6,children:e(Me,{disabled:t,sx:{width:1},name:"mobileNumber",label:"Mobile Number"})}),i&&e(u,{item:!0,marginLeft:"auto",children:i(p)})]})]})},Ye=()=>{const{isEditing:t,startEditing:i,stopEditing:r}=ne();return o(L,{children:[o(w,{sx:{bgcolor:"background.neutral"},children:[e(V,{title:"Contact Details",action:t?void 0:e(q,{onClick:i,children:e(y,{icon:$.pencil})})}),e(O,{})]}),e(E,{children:e(Ze,{disabled:!t,onSuccess:r,action:a=>e(J,{children:t&&o(D,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e(X,{size:"large",onClick:r,children:"Cancel"}),e(N,{size:"large",type:"submit",variant:"contained",loading:a,children:"Save Changes"})]})})})})]})},Je=({loading:t,children:i,...r})=>e(q,{disabled:t,...r,children:t?e(ge,{size:24}):i}),Xe=t=>{const[i,r]=x.useState(!1),a=ee(),s=G();return e(N,{startIcon:e(y,{icon:"ri:login-circle-line",rotate:2}),...t,color:"error",variant:"contained",loading:i,onClick:async()=>{try{await a({description:"Are you sure you want to log out from all devices?"}),r(!0),await ye(),s.invalidateQueries([K.FetchLoginSessionList])}catch(d){console.log("ðŸš€ ~ file: ProfileMain.jsx:15 ~ handleLogoutAll ~ error",d)}finally{r(!1)}},children:"Logout All Sessions"})},et=()=>{const{user:{loginSessionId:t}}=F(),i=ee(),[r,a]=x.useState(null),s=K.FetchLoginSessionList,l=G(),d=async n=>{try{await i({description:"Are you sure want to log out?"}),a(n),await be(n),l.invalidateQueries([s])}catch(m){console.log("ðŸš€ ~ file: ProfileMainLoginSessions.jsx:18 ~ handleTokeExpire ~ error",m)}finally{a(null)}},c=[{field:"createdAt",sort:"desc"}],p=[{field:"location",headerName:k("location"),minWidth:200,flex:1,renderCell:({value:n})=>e(_,{title:n,children:e(w,{children:n})})},{field:"device",headerName:k("device"),minWidth:300,flex:1},{field:"ip",headerName:k("ip"),minWidth:150,flex:1},{field:"createdAt",headerName:k("time"),minWidth:200,flex:1,filterable:!1,renderCell:({value:n})=>Ve(n)},{field:"status",headerName:k("session"),minWidth:50,flex:.5,renderCell({value:n}){const m=()=>n==="active"?"lucide:check-circle":"ri:close-circle-line",h=()=>n==="active"?"success":"error";return e(_,{title:U(n),children:e(w,{children:e(y,{color:h()+".main",sx:{fontSize:24},icon:m()})})})}},{field:"id",headerName:k("action"),maxWidth:100,sortable:!1,flex:1,renderCell({row:{id:n,status:m}}){return m==="active"?e(J,{children:n===t?"This device":e(Je,{loading:r===n,onClick:()=>d(n),children:e(y,{icon:$.delete})})}):e(w,{children:U(m)})}}];return e(Oe,{title:o(w,{children:["Login Sessions",e(Xe,{sx:{ml:2}})]}),queryKey:s,sortModel:c,columns:p})};function tt(){const{user:t,updateUser:i}=F(),{isEditing:r,startEditing:a,stopEditing:s}=ne(),{kyc:l,kycData:{user:d,form:c}}=t,p=I().shape({firstName:g().required("First Name is required").max(15,"Maximum 15 characters are allowed"),lastName:g().required("Last Name is required").max(15,"Maximum 15 characters are allowed"),kyc:I().shape({...c.reduce((f,{labelId:P,label:ae,required:oe,inputType:Q})=>{let T=g();return oe==="required"&&(T=T.required(`${ae} is required`)),Q==="textarea"&&(T=T.max(1e3,"Maximum 1000 characters are allowed")),Q==="input"&&(T=T.max(30,"Maximum 30 characters are allowed")),{...f,[P]:T}},{})})}),n={firstName:t.firstName,lastName:t.lastName,kyc:{...c.reduce((f,{labelId:P})=>({...f,[P]:d[P]??""}),{})}},m=R({resolver:M(p),defaultValues:n}),{setValue:h,handleSubmit:A,formState:{isSubmitting:C}}=m,v=async f=>{try{const P=await we(f);i(P.data.user),s()}catch(P){console.error(P)}};return o(L,{children:[o(w,{sx:{bgcolor:"background.neutral"},children:[e(V,{title:"My Profile",action:r?void 0:e(q,{onClick:a,children:e(y,{icon:$.pencil})})}),e(O,{})]}),e(E,{children:e(j,{methods:m,onSubmit:A(v),children:o(u,{container:!0,spacing:2,children:[e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:!r,name:"firstName",type:"text",label:"First Name"})}),e(u,{item:!0,xs:12,md:6,children:e(b,{disabled:!r,name:"lastName",type:"text",label:"Last Name"})}),c.map(f=>e(u,{item:!0,xs:12,md:6,children:e(rt,{disabled:!r||l==="approved"&&f.required==="required",setValue:h,name:f.labelId,...f})},f.labelId)),e(u,{item:!0,marginLeft:"auto",children:r&&o(D,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e(X,{size:"large",onClick:s,children:"Cancel"}),e(N,{size:"large",type:"submit",variant:"contained",loading:C,children:"Save Changes"})]})})]})})})]})}function rt({setValue:t,label:i,inputType:r,fileExtensions:a,dropdownOptions:s,name:l,disabled:d}){switch(l=`kyc.${l}`,r){case"input":return e(b,{disabled:d,name:l,label:i});case"textarea":return e(b,{disabled:d,multiline:!0,minRows:4,name:l,label:i});case"date":return e(Be,{disabled:d,name:l,label:i});case"dropdown":return e(Ce,{disabled:d,name:l,label:i,children:s.map(({option:c})=>e(ve,{value:c,children:c},c))});case"file":return o(w,{children:[e(ze,{label:i}),e(xe,{disabled:d,setValue:t,name:l})]})}}const it=()=>o(u,{container:!0,spacing:te,children:[e(u,{item:!0,xs:12,md:4,children:e(Re,{})}),e(u,{item:!0,xs:12,md:8,children:e(tt,{})}),e(u,{item:!0,xs:12,md:12,children:e(Ye,{})}),e(u,{item:!0,xs:12,md:12,children:e(et,{})})]}),nt=({resend:t,open:i,onClose:r})=>{const{updateTwoFA:a,user:{twoFA:s=!1,email:l}={}}=F(),[d,c]=x.useState(!1),p=I().shape({verificationCode:g().required("Verification Code is required").length(6,"Verification Code is invalid")}),n=R({defaultValues:{verificationCode:"",step:2},resolver:M(p)}),{formState:{isSubmitting:m},handleSubmit:h}=n,A=async v=>{try{const{data:{twoFA:f}}=await H({status:s,...v});r(),a(f)}catch(f){console.log("ðŸš€ ~ file: RegisterVerifyOtp.jsx:31 ~ onSubmit ~ error",f)}},C=async()=>{try{c(!0),await t()}catch(v){console.log("ðŸš€ ~ file: RegisterVerifyOtp.jsx:43 ~ handleResendOtp ~ error",v)}finally{c(!1)}};return o(Pe,{open:i,onClose:r,children:[e(Se,{children:s?"Disable Two Factor Authentication":"Enable Two Factor Authentication"}),e(Ae,{children:o(E,{sx:{textAlign:"center",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",gap:2},children:[e(Y,{src:"https://jamsrworld.com/demo/binary-mlm/assets/media/svg/misc/smartphone-2.svg",sx:{width:200}}),e(S,{variant:"h4",children:"Otp Verification"}),e(S,{color:"text.secondary",children:"Enter the verification code sent to "}),e(S,{children:l}),o(j,{methods:n,onSubmit:h(A),children:[e(Te,{name:"verificationCode",label:"Otp"}),e(N,{type:"submit",sx:{mt:2},loading:m,variant:"contained",size:"large",fullWidth:!0,children:"Verify"})]}),o(S,{sx:{color:"text.secondary"},variant:"body2",children:["Didn't get the code?"," ",d?e(Z,{sx:{cursor:"pointer",opacity:.7},children:"Sending..."}):e(Z,{onClick:C,sx:{cursor:"pointer"},children:"Resend"})]})]})})]})},at=()=>{const[t,i]=x.useState(!1),{user:{twoFA:r=!1}={}}=F(),[a,s]=x.useState(!1),l=()=>s(!1),d=()=>s(!0);return o(L,{children:[e(nt,{resend:async()=>H({step:1,status:r}),open:a,onClose:l}),e(V,{sx:{bgcolor:"background.neutral"},title:"Two Factor Authentication"}),e(O,{}),e(E,{children:o(D,{spacing:3,children:[e(S,{children:"Secure Your Account"}),e(S,{children:"Two-factor authentication adds an extra layer of security to your account. To log in, in addition you'll need to provide a 6 digit code"}),e(w,{children:e(N,{loading:t,color:"error",variant:"contained",onClick:async()=>{try{i(!0),await H({step:1,status:r}),d()}catch(n){console.log("ðŸš€ ~ file: ProfileSecurityTwoFA.jsx:17 ~ setTwoFa ~ error",n)}finally{i(!1)}},children:r?"Disable Two Factor Authentication":"Enable Two Factor Authentication"})})]})})]})},ot=()=>{const{logout:t}=F(),i=Fe(),r=G(),a=I().shape({password:g().required("Old Password is required"),newPassword:g().required("New Password is required").min(6,"Password must be at least 6 characters long").max(20,"Maximum 20 characters are allowed"),confirmNewPassword:g().required("Confirm New Password is required").oneOf([ke("newPassword"),null],"Passwords are not matching")}),s={password:"",newPassword:"",confirmNewPassword:""},l=R({resolver:M(a),defaultValues:s}),{handleSubmit:d,formState:{isSubmitting:c}}=l,p=async A=>{try{await Ne(A),t(),r.invalidateQueries(),i(Ie.login)}catch(C){console.error(C)}},[n,m]=x.useState(!1),h=()=>{m(!n)};return o(L,{children:[o(w,{sx:{bgcolor:"background.neutral"},children:[e(V,{title:"Change Password"}),e(O,{})]}),e(E,{children:e(j,{methods:l,onSubmit:d(p),children:o(D,{spacing:3,children:[e(b,{autoComplete:"new-password",name:"password",type:n?"text":"password",label:"Current Password",InputProps:{endAdornment:e(z,{position:"end",children:e(q,{"aria-label":"Toggle Password",onClick:h,edge:"end",children:n?e(y,{icon:"eva:eye-off-fill"}):e(y,{icon:"eva:eye-fill"})})})}}),e(b,{name:"newPassword",type:n?"text":"password",label:"New Password",InputProps:{endAdornment:e(z,{position:"end",children:e(q,{"aria-label":"Toggle Password",onClick:h,edge:"end",children:n?e(y,{icon:"eva:eye-off-fill"}):e(y,{icon:"eva:eye-fill"})})})}}),e(b,{name:"confirmNewPassword",type:n?"text":"password",label:"Confirm New Password",InputProps:{endAdornment:e(z,{position:"end",children:e(q,{"aria-label":"Toggle Password",onClick:h,edge:"end",children:n?e(y,{icon:"eva:eye-off-fill"}):e(y,{icon:"eva:eye-fill"})})})}}),o(re,{icon:!1,variant:"outlined",severity:"error",children:[e(ie,{children:"Password Requirements"}),o(qe,{sx:{listStyle:"disc inside","& li":{display:"list-item"}},children:[e(B,{children:"Minimum 6 characters long - the more, the better"}),e(B,{children:"At least one lowercase & one uppercase character"}),e(B,{children:"At least one number, symbol"})]})]}),e(N,{sx:{marginLeft:"auto !important"},size:"large",type:"submit",variant:"contained",loading:c,children:"Change Password"})]})})})]})},st=()=>o(D,{spacing:3,children:[e(ot,{}),e(at,{})]}),lt=W("div")(({theme:t})=>({zIndex:9,bottom:0,width:"100%",display:"flex",position:"absolute",backgroundColor:t.palette.background.paper,[t.breakpoints.up("sm")]:{justifyContent:"center"},[t.breakpoints.up("md")]:{justifyContent:"flex-end",paddingRight:t.spacing(3)}})),ct=()=>{const{currentTab:t,onChangeTab:i}=We("profile"),r=[{value:"profile",icon:e(y,{icon:"ic:round-account-box",width:20,height:20}),component:e(it,{})},{value:"security",icon:e(y,{icon:"mdi:secure",width:20,height:20}),component:e(st,{})}];return o(Le,{title:"Profile",children:[e(De,{heading:"Profile",links:[{name:"Dashboard"},{name:"Profile"}]}),e(Qe,{}),o(L,{sx:{mb:te,height:{xs:340,md:280},position:"relative"},children:[e(Ge,{}),e(lt,{children:e(He,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:t,onChange:i,children:r.map(a=>e(Ue,{disableRipple:!0,value:a.value,icon:a.icon,label:U(a.value)},a.value))})})]}),r.map(a=>a.value===t&&e(w,{children:a.component},a.value))]})},Nt=ct;export{Nt as default};
